{"version":3,"sources":["Check.js","ErrorIcon.js","Spinner.js","App.js","Layout.js","Loading.js","index.js"],"names":["Check","xmlns","height","viewBox","width","fill","d","ErrorIcon","Spinner","className","PROPOSALS","ShowAccount","account","ShowMyTokens","myTokens","resetMyVotes","useCacheSend","drizzleHooks","useDrizzle","send","onClick","ShowPersonalInfo","AdminInfo","React","addr","setAddr","setupStudent","type","placeholder","value","onChange","e","target","sortProposals","proposals","copy","sort","a","b","votes","fromTo","from","to","arr","i","push","enoughVotes","ShowTransaction","tid","status","color","ShowTransactions","transactions","reversed","Object","entries","reverse","length","map","console","log","SetButton","name","voteString","setVoteString","int","parseInt","isNaN","setVotes","Proposals","admin","useCacheCall","call","p","myVotes","voteFor","disabled","App","useDrizzleState","drizzleState","accounts","Nav","Layout","props","children","Loading","options","contracts","web3","fallback","url","drizzleStore","generateStore","drizzle","Drizzle","ReactDOM","render","StrictMode","DrizzleProvider","Initializer","error","loadingContractsAndAccounts","loadingWeb3","document","getElementById"],"mappings":"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","file":"static/js/main.249f6f9f.chunk.js","sourcesContent":["export default function Check() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentColor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM10 17l-3.5-3.5 1.41-1.41L10 14.17 15.18 9l1.41 1.41L10 17z\" />\n    </svg>\n  );\n}\n","export default function ErrorIcon() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      width=\"24\"\n      fill=\"currentColor\"\n    >\n      <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n      <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z\" />\n    </svg>\n  );\n}\n","export default function Spinner() {\n  return (\n    <div className=\"self-building-square-spinner\">\n      <div className=\"square\"></div>\n      <div className=\"square\"></div>\n      <div className=\"square\"></div>\n      <div className=\"square clear\"></div>\n      <div className=\"square\"></div>\n      <div className=\"square\"></div>\n      <div className=\"square clear\"></div>\n      <div className=\"square\"></div>\n      <div className=\"square\"></div>\n    </div>\n  );\n}\n","import { drizzleReactHooks as drizzleHooks } from \"@drizzle/react-plugin\";\nimport * as React from \"react\";\nimport Check from \"./Check\";\nimport ErrorIcon from \"./ErrorIcon\";\nimport Spinner from \"./Spinner\";\n\nconst PROPOSALS = [\n  \"Nothing\",\n  \"Dog\",\n  \"Cat\",\n  \"Penguin\",\n  \"Monkey\",\n  \"Koala\",\n  \"Rabbit\",\n  \"Panda\",\n];\n\nfunction ShowAccount({ account }) {\n  return (\n    <div className=\"space-y-2\">\n      <h2 className=\"text-gray-800 text-xl font-bold\">My Account</h2>\n      <p className=\"text-gray-700 font-mono text-xs sm:text-base\">{account}</p>\n    </div>\n  );\n}\n\nfunction ShowMyTokens({ myTokens }) {\n  const { useCacheSend } = drizzleHooks.useDrizzle();\n  const { send: resetMyVotes } = useCacheSend(\"Proposals\", \"resetMyVotes\");\n\n  return (\n    <div className=\"space-y-6\">\n      <p className=\"text-gray-800 text-2xl\">\n        <span className=\"font-bold\">{myTokens}</span> animal tokens\n      </p>\n      <button\n        onClick={() => resetMyVotes()}\n        className=\"motion-reduce:transition-none transition-colors duration-300 ease-in-out bg-indigo-500 hover:bg-red-500 text-white text-lg font-bold px-2 py-1 rounded\"\n      >\n        Reset Votes\n      </button>\n    </div>\n  );\n}\n\nfunction ShowPersonalInfo({ account, myTokens }) {\n  return (\n    <div className=\"bg-white p-4 shadow rounded-md space-y-2\">\n      <ShowAccount account={account} />\n      <ShowMyTokens myTokens={myTokens} />\n    </div>\n  );\n}\n\nfunction AdminInfo({ account }) {\n  const [addr, setAddr] = React.useState(\"\");\n  const { useCacheSend } = drizzleHooks.useDrizzle();\n  const { send: setupStudent } = useCacheSend(\"Proposals\", \"setupStudent\");\n\n  return (\n    <div className=\"bg-white p-4 rounded-md shadow space-y-6 text-gray-800\">\n      <h2 className=\"text-2xl font-bold\">Owner's Section</h2>\n      <div className=\"space-y-3\">\n        <input\n          type=\"text\"\n          placeholder=\"Ethereum Address\"\n          value={addr}\n          onChange={(e) => setAddr(e.target.value)}\n          className=\"shadow-inner text-base sm:text-xl px-2 bg-gray-50 rounded-md placeholder-gray-700 font-mono w-full\"\n        ></input>\n        <button\n          onClick={() => setupStudent(addr)}\n          className=\"transition-colors duration-300 ease-in-out text-white rounded text-lg shadow font-bold py-1 px-2 bg-indigo-500 hover:bg-blue-400\"\n        >\n          Initialize Student\n        </button>\n      </div>\n    </div>\n  );\n}\n\nfunction sortProposals(proposals) {\n  const copy = [...proposals];\n  copy.sort((a, b) => b.votes - a.votes);\n  return copy;\n}\n\nfunction fromTo(from, to) {\n  const arr = [];\n  for (let i = from; i < to; ++i) {\n    arr.push(i);\n  }\n  return arr;\n}\n\nfunction enoughVotes(myTokens, votes) {\n  return myTokens >= 2 * votes + 1;\n}\n\nfunction ShowTransaction({ tid, status }) {\n  let placeholder = <Spinner />;\n  let color = \"text-blue-600\";\n  if (status === \"success\") {\n    placeholder = <Check />;\n    color = \"text-green-600\";\n  } else if (status === \"error\") {\n    placeholder = <ErrorIcon />;\n    color = \"text-red-600\";\n  }\n  return (\n    <li className={`flex space-x-4 items-center ${color} space-y-2`}>\n      <div className=\"w-6\">{placeholder}</div>\n      <div className=\"font-bold pb-1\">{tid}</div>\n    </li>\n  );\n}\n\nfunction ShowTransactions({ transactions }) {\n  const reversed = [...Object.entries(transactions)];\n  reversed.reverse();\n  if (reversed.length == 0) {\n    return <></>;\n  }\n  return (\n    <ul className=\"bg-white rounded shadow-md p-4\">\n      {reversed.map(([tid, { status }]) => {\n        console.log(\"first key\", tid);\n        return <ShowTransaction key={tid} tid={tid} status={status} />;\n      })}\n    </ul>\n  );\n}\n\nfunction SetButton({ name }) {\n  const { useCacheSend } = drizzleHooks.useDrizzle();\n  const [voteString, setVoteString] = React.useState(\"0\");\n  const { send } = useCacheSend(\"Proposals\", \"setVotes\");\n  const setVotes = () => {\n    const int = parseInt(voteString);\n    if (isNaN(int)) {\n      return;\n    }\n    send(name, int);\n  };\n\n  return (\n    <div className=\"pl-16 flex items-end space-x-4\">\n      <input\n        type=\"number\"\n        value={voteString}\n        className=\"w-12 rounded shadow-inner px-1 bg-gray-50\"\n        onChange={(e) => setVoteString(e.target.value)}\n      ></input>\n      <button\n        className=\"transition-colors text-white text-sm p-1 font-bold bg-indigo-500 hover:bg-blue-400 rounded\"\n        onClick={() => setVotes()}\n      >\n        Set Votes\n      </button>\n    </div>\n  );\n}\n\nfunction Proposals({ myTokens, admin }) {\n  const { useCacheCall, useCacheSend } = drizzleHooks.useDrizzle();\n\n  const proposals = useCacheCall([\"Proposals\"], (call) =>\n    PROPOSALS.map((p, i) => ({\n      name: p,\n      votes: call(\"Proposals\", \"proposals\", i),\n      myVotes: call(\"Proposals\", \"myVotes\", p),\n    }))\n  );\n  const { send: voteFor } = useCacheSend(\"Proposals\", \"voteFor\");\n\n  return (\n    <ul className=\"bg-white p-4 rounded shadow-md text-xl text-gray-800\">\n      {sortProposals(proposals).map(({ name, votes, myVotes }) => (\n        <li key={name} className=\"flex items-center space-x-4\">\n          <div className=\"text-2xl w-1/3\">{name}</div>\n          <div className=\"flex items-center space-x-4 justify-between\">\n            <div className=\"text-gray-700 w-24\">\n              <span className=\"font-bold\">{votes}</span>{\" \"}\n              {votes == 1 ? \"vote\" : \"votes\"}\n            </div>\n            <div className=\"flex items-center flex-grow space-x-2\">\n              {fromTo(0, myVotes).map((i) => (\n                <div\n                  key={i}\n                  className=\"w-6 h-6 bg-gradient-to-r from-indigo-500 to-blue-500 rounded\"\n                ></div>\n              ))}\n              <button\n                onClick={() => voteFor(name)}\n                disabled={!enoughVotes(myTokens, myVotes)}\n                className={`transition-colors border-2 border-dashed w-6 h-6 ${\n                  !enoughVotes(myTokens, myVotes)\n                    ? \"border-red-500\"\n                    : \"border-indigo-500 hover:border-blue-400\"\n                }`}\n              ></button>\n            </div>\n          </div>\n          {admin ? <SetButton name={name} /> : <></>}\n        </li>\n      ))}\n    </ul>\n  );\n}\n\nexport default function App() {\n  const { account, transactions } = drizzleHooks.useDrizzleState(\n    (drizzleState) => ({\n      account: drizzleState.accounts[0],\n      transactions: drizzleState.transactions,\n    })\n  );\n\n  const { useCacheCall } = drizzleHooks.useDrizzle();\n\n  const myTokens = useCacheCall(\"Proposals\", \"tokens\", account);\n  const theOwner = useCacheCall(\"Proposals\", \"owner\");\n  const admin = theOwner === account;\n\n  return (\n    <div className=\"lg:flex flex-wrap space-y-6 lg:space-y-0 lg:space-x-8 mx-auto px-4 sm:px-0 sm:w-10/12\">\n      <div className=\"space-y-6\">\n        {admin ? <AdminInfo account={account} /> : null}\n        <ShowPersonalInfo account={account} myTokens={myTokens} />\n      </div>\n      <div className=\"flex flex-col lg:flex-grow space-y-2\">\n        <Proposals myTokens={myTokens} admin={admin} />\n        <ShowTransactions transactions={transactions} />\n      </div>\n    </div>\n  );\n}\n","function Nav() {\n  return (\n    <nav className=\"bg-gradient-to-r from-indigo-500 to-blue-500 h-16 flex items-center text-white font-bold text-3xl mb-8 shadow-md\">\n      <div className=\"mx-8\">Animal Vote</div>\n    </nav>\n  );\n}\n\nexport default function Layout(props) {\n  return (\n    <>\n      <Nav />\n      <main>{props.children}</main>\n    </>\n  );\n}\n","import Spinner from \"./Spinner\";\n\nexport default function Loading() {\n  return <div className=\"text-lg text-blue-800 flex flex-col items-center max-auto\">\n    <Spinner />\n    <p>\n      Currently loading the DAPP application\n      <br />\n      If this is taking a while, make sure that MetaMask is using the <b>Ropsten </b>\n      network.\n    </p>\n  </div>\n}","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport Layout from \"./Layout\"\nimport { Drizzle, generateStore } from \"@drizzle/store\";\nimport { drizzleReactHooks as drizzleHooks } from \"@drizzle/react-plugin\";\nimport Proposals from \"./contracts/Proposals.json\";\nimport Loading from \"./Loading\";\n\nconst options = {\n  contracts: [Proposals],\n  web3: {\n    fallback: {\n      type: \"ws\",\n      url: \"ws://127.0.0.1:9545\",\n    },\n  },\n};\n\nconst drizzleStore = generateStore(options);\nconst drizzle = new Drizzle(options, drizzleStore);\n\nReactDOM.render(\n  <React.StrictMode>\n    <Layout>\n      <drizzleHooks.DrizzleProvider drizzle={drizzle}>\n        <drizzleHooks.Initializer\n          // Optional `node` to render on errors. Defaults to `'Error.'`.\n          error=\"There was an error.\"\n          loadingContractsAndAccounts={<Loading />}\n          loadingWeb3={<Loading />}\n        >\n          <App />\n        </drizzleHooks.Initializer>\n      </drizzleHooks.DrizzleProvider>\n    </Layout>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}